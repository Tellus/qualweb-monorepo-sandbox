name: "@qualweb/best-practices"
on:
  pull_request:
    branches:
      - main
      - develop
    paths:
      - "packages/best-practices/**"

jobs:
  unit_tests:
    name: Unit tests
    runs-on: ubuntu-latest
    steps:
      # Setup/prelims
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup (cache, dependencies)
        uses: ./.github/actions/install_and_cache_dependencies

      # Build all packages. This ensures that everything this package depends on
      # has also been built.
      - name: Build
        run: npm -ws run build

      # Run unit tests on this package, and its dependents.

      - name: "Unit tests for this package"
        run: npm -w @qualweb/best-practices test
      
      - name: "Test dependents"
        run: npm run $(npx ts-node scripts/get_dependents.ts --as-workspaces @qualweb/best-practices) test